ARM GAS  D:\Temp\cc8obYI6.s 			page 1


   1              		.cpu cortex-m0
   2              		.arch armv6s-m
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 4
  11              		.eabi_attribute 34, 0
  12              		.eabi_attribute 18, 4
  13              		.file	"SD3077.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.file 1 "Lib/SD3077.c"
  18              		.section	.text.UnlockWriteProtect,"ax",%progbits
  19              		.align	1
  20              		.syntax unified
  21              		.code	16
  22              		.thumb_func
  24              	UnlockWriteProtect:
  25              	.LFB39:
   1:Lib/SD3077.c  **** #include "SD3077.h"
   2:Lib/SD3077.c  **** 
   3:Lib/SD3077.c  **** static uint8_t bcd2bin (uint8_t val) { return val - 6 * (val >> 4); }
   4:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
   5:Lib/SD3077.c  **** 
   6:Lib/SD3077.c  **** static void UnlockWriteProtect(){
  26              		.loc 1 6 33 view -0
  27              		.cfi_startproc
  28              		@ args = 0, pretend = 0, frame = 8
  29              		@ frame_needed = 0, uses_anonymous_args = 0
   7:Lib/SD3077.c  **** 	// 读出控制寄存器中的数据
   8:Lib/SD3077.c  **** 	uint8_t srcData[2];
  30              		.loc 1 8 2 view .LVU1
   9:Lib/SD3077.c  **** 	HAL_I2C_Mem_Read(&SD3077_IIC_HANDLE, SD3077_IIC_ADDR_READ, 0x0F, 1, srcData, 2, HAL_MAX_DELAY);
  31              		.loc 1 9 2 view .LVU2
   6:Lib/SD3077.c  **** 	// 读出控制寄存器中的数据
  32              		.loc 1 6 33 is_stmt 0 view .LVU3
  33 0000 F0B5     		push	{r4, r5, r6, r7, lr}
  34              	.LCFI0:
  35              		.cfi_def_cfa_offset 20
  36              		.cfi_offset 4, -20
  37              		.cfi_offset 5, -16
  38              		.cfi_offset 6, -12
  39              		.cfi_offset 7, -8
  40              		.cfi_offset 14, -4
  41              		.loc 1 9 2 view .LVU4
  42 0002 0125     		movs	r5, #1
  43 0004 0223     		movs	r3, #2
   6:Lib/SD3077.c  **** 	// 读出控制寄存器中的数据
  44              		.loc 1 6 33 view .LVU5
  45 0006 87B0     		sub	sp, sp, #28
  46              	.LCFI1:
  47              		.cfi_def_cfa_offset 48
ARM GAS  D:\Temp\cc8obYI6.s 			page 2


  48              		.loc 1 9 2 view .LVU6
  49 0008 1E4C     		ldr	r4, .L2
  50 000a 05AF     		add	r7, sp, #20
  51 000c 6D42     		rsbs	r5, r5, #0
  52 000e 0295     		str	r5, [sp, #8]
  53 0010 0193     		str	r3, [sp, #4]
  54 0012 0F22     		movs	r2, #15
  55 0014 5B19     		adds	r3, r3, r5
  56 0016 6521     		movs	r1, #101
  57 0018 2000     		movs	r0, r4
  58 001a 0097     		str	r7, [sp]
  59 001c FFF7FEFF 		bl	HAL_I2C_Mem_Read
  60              	.LVL0:
  10:Lib/SD3077.c  **** 
  11:Lib/SD3077.c  **** 	// 更改后写入
  12:Lib/SD3077.c  **** 	uint8_t data = srcData[1] | 0x80;
  61              		.loc 1 12 2 is_stmt 1 view .LVU7
  62              		.loc 1 12 10 is_stmt 0 view .LVU8
  63 0020 8023     		movs	r3, #128
  64 0022 1326     		movs	r6, #19
  65 0024 7A78     		ldrb	r2, [r7, #1]
  66 0026 5B42     		rsbs	r3, r3, #0
  67 0028 6E44     		add	r6, r6, sp
  68 002a 1343     		orrs	r3, r2
  69 002c 3370     		strb	r3, [r6]
  13:Lib/SD3077.c  **** 	HAL_I2C_Mem_Write(&SD3077_IIC_HANDLE, SD3077_IIC_ADDR_WRITE, 0x10, 1, &data, 1, HAL_MAX_DELAY);
  70              		.loc 1 13 2 is_stmt 1 view .LVU9
  71 002e 0295     		str	r5, [sp, #8]
  72 0030 0235     		adds	r5, r5, #2
  73 0032 2B00     		movs	r3, r5
  74 0034 1022     		movs	r2, #16
  75 0036 6421     		movs	r1, #100
  76 0038 2000     		movs	r0, r4
  77 003a 0195     		str	r5, [sp, #4]
  78 003c 0096     		str	r6, [sp]
  79 003e FFF7FEFF 		bl	HAL_I2C_Mem_Write
  80              	.LVL1:
  14:Lib/SD3077.c  **** 	data = srcData[0] | 0x04;
  81              		.loc 1 14 2 view .LVU10
  82              		.loc 1 14 7 is_stmt 0 view .LVU11
  83 0042 0423     		movs	r3, #4
  84 0044 3A78     		ldrb	r2, [r7]
  15:Lib/SD3077.c  **** 	HAL_I2C_Mem_Write(&SD3077_IIC_HANDLE, SD3077_IIC_ADDR_WRITE, 0x0F, 1, &data, 1, HAL_MAX_DELAY);
  85              		.loc 1 15 2 view .LVU12
  86 0046 6421     		movs	r1, #100
  14:Lib/SD3077.c  **** 	data = srcData[0] | 0x04;
  87              		.loc 1 14 7 view .LVU13
  88 0048 1343     		orrs	r3, r2
  89 004a 3370     		strb	r3, [r6]
  90              		.loc 1 15 2 is_stmt 1 view .LVU14
  91 004c 0123     		movs	r3, #1
  92 004e 5B42     		rsbs	r3, r3, #0
  93 0050 0293     		str	r3, [sp, #8]
  94 0052 0F22     		movs	r2, #15
  95 0054 2B00     		movs	r3, r5
  96 0056 2000     		movs	r0, r4
  97 0058 0195     		str	r5, [sp, #4]
ARM GAS  D:\Temp\cc8obYI6.s 			page 3


  98 005a 0096     		str	r6, [sp]
  99 005c FFF7FEFF 		bl	HAL_I2C_Mem_Write
 100              	.LVL2:
  16:Lib/SD3077.c  **** 	data = srcData[0] | 0x84;
 101              		.loc 1 16 2 view .LVU15
 102              		.loc 1 16 7 is_stmt 0 view .LVU16
 103 0060 7C23     		movs	r3, #124
 104 0062 3A78     		ldrb	r2, [r7]
 105 0064 5B42     		rsbs	r3, r3, #0
 106 0066 1343     		orrs	r3, r2
 107 0068 3370     		strb	r3, [r6]
  17:Lib/SD3077.c  **** 	HAL_I2C_Mem_Write(&SD3077_IIC_HANDLE, SD3077_IIC_ADDR_WRITE, 0x0F, 1, &data, 1, HAL_MAX_DELAY);
 108              		.loc 1 17 2 is_stmt 1 view .LVU17
 109 006a 0123     		movs	r3, #1
 110 006c 5B42     		rsbs	r3, r3, #0
 111 006e 0293     		str	r3, [sp, #8]
 112 0070 0F22     		movs	r2, #15
 113 0072 2B00     		movs	r3, r5
 114 0074 6421     		movs	r1, #100
 115 0076 2000     		movs	r0, r4
 116 0078 0195     		str	r5, [sp, #4]
 117 007a 0096     		str	r6, [sp]
 118 007c FFF7FEFF 		bl	HAL_I2C_Mem_Write
 119              	.LVL3:
  18:Lib/SD3077.c  **** }
 120              		.loc 1 18 1 is_stmt 0 view .LVU18
 121 0080 07B0     		add	sp, sp, #28
 122              		@ sp needed
 123 0082 F0BD     		pop	{r4, r5, r6, r7, pc}
 124              	.L3:
 125              		.align	2
 126              	.L2:
 127 0084 00000000 		.word	hi2c1
 128              		.cfi_endproc
 129              	.LFE39:
 131              		.section	.text.TimeNow,"ax",%progbits
 132              		.align	1
 133              		.global	TimeNow
 134              		.syntax unified
 135              		.code	16
 136              		.thumb_func
 138              	TimeNow:
 139              	.LVL4:
 140              	.LFB40:
  19:Lib/SD3077.c  **** 
  20:Lib/SD3077.c  **** void TimeNow(DateTime *dateTime){
 141              		.loc 1 20 33 is_stmt 1 view -0
 142              		.cfi_startproc
 143              		@ args = 0, pretend = 0, frame = 8
 144              		@ frame_needed = 0, uses_anonymous_args = 0
  21:Lib/SD3077.c  **** 	uint8_t data[7];
 145              		.loc 1 21 2 view .LVU20
  22:Lib/SD3077.c  **** 	HAL_I2C_Mem_Read(&SD3077_IIC_HANDLE, SD3077_IIC_ADDR_READ, 0x00, 1, data, 7, HAL_MAX_DELAY);
 146              		.loc 1 22 2 view .LVU21
 147 0000 0123     		movs	r3, #1
  20:Lib/SD3077.c  **** 	uint8_t data[7];
 148              		.loc 1 20 33 is_stmt 0 view .LVU22
ARM GAS  D:\Temp\cc8obYI6.s 			page 4


 149 0002 30B5     		push	{r4, r5, lr}
 150              	.LCFI2:
 151              		.cfi_def_cfa_offset 12
 152              		.cfi_offset 4, -12
 153              		.cfi_offset 5, -8
 154              		.cfi_offset 14, -4
 155              		.loc 1 22 2 view .LVU23
 156 0004 5B42     		rsbs	r3, r3, #0
  20:Lib/SD3077.c  **** 	uint8_t data[7];
 157              		.loc 1 20 33 view .LVU24
 158 0006 87B0     		sub	sp, sp, #28
 159              	.LCFI3:
 160              		.cfi_def_cfa_offset 40
 161              		.loc 1 22 2 view .LVU25
 162 0008 04AD     		add	r5, sp, #16
 163 000a 0293     		str	r3, [sp, #8]
 164 000c 0833     		adds	r3, r3, #8
  20:Lib/SD3077.c  **** 	uint8_t data[7];
 165              		.loc 1 20 33 view .LVU26
 166 000e 0400     		movs	r4, r0
 167              		.loc 1 22 2 view .LVU27
 168 0010 0022     		movs	r2, #0
 169 0012 6521     		movs	r1, #101
 170 0014 0193     		str	r3, [sp, #4]
 171 0016 2148     		ldr	r0, .L7
 172              	.LVL5:
 173              		.loc 1 22 2 view .LVU28
 174 0018 063B     		subs	r3, r3, #6
 175 001a 0095     		str	r5, [sp]
 176 001c FFF7FEFF 		bl	HAL_I2C_Mem_Read
 177              	.LVL6:
  23:Lib/SD3077.c  **** 	dateTime->seconds = bcd2bin(data[0]);
 178              		.loc 1 23 2 is_stmt 1 view .LVU29
 179              	.LBB34:
 180              	.LBB35:
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 181              		.loc 1 3 51 is_stmt 0 view .LVU30
 182 0020 0622     		movs	r2, #6
 183              	.LBE35:
 184              	.LBE34:
 185              		.loc 1 23 22 view .LVU31
 186 0022 2B78     		ldrb	r3, [r5]
 187              	.LVL7:
 188              	.LBB37:
 189              	.LBI34:
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 190              		.loc 1 3 16 is_stmt 1 view .LVU32
 191              	.LBB36:
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 192              		.loc 1 3 40 view .LVU33
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 193              		.loc 1 3 51 is_stmt 0 view .LVU34
 194 0024 5242     		rsbs	r2, r2, #0
 195 0026 1909     		lsrs	r1, r3, #4
 196 0028 5143     		muls	r1, r2
 197 002a 5B18     		adds	r3, r3, r1
 198              	.LBE36:
ARM GAS  D:\Temp\cc8obYI6.s 			page 5


 199              	.LBE37:
 200              		.loc 1 23 20 discriminator 1 view .LVU35
 201 002c 2370     		strb	r3, [r4]
  24:Lib/SD3077.c  **** 	dateTime->minutes = bcd2bin(data[1]);
 202              		.loc 1 24 2 is_stmt 1 view .LVU36
 203              		.loc 1 24 22 is_stmt 0 view .LVU37
 204 002e 6B78     		ldrb	r3, [r5, #1]
 205              	.LVL8:
 206              	.LBB38:
 207              	.LBI38:
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 208              		.loc 1 3 16 is_stmt 1 view .LVU38
 209              	.LBB39:
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 210              		.loc 1 3 40 view .LVU39
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 211              		.loc 1 3 51 is_stmt 0 view .LVU40
 212 0030 1909     		lsrs	r1, r3, #4
 213 0032 5143     		muls	r1, r2
 214 0034 5B18     		adds	r3, r3, r1
 215              	.LBE39:
 216              	.LBE38:
  25:Lib/SD3077.c  **** 
  26:Lib/SD3077.c  **** 	if(data[2] >> 7){
 217              		.loc 1 26 4 view .LVU41
 218 0036 0221     		movs	r1, #2
  24:Lib/SD3077.c  **** 	dateTime->minutes = bcd2bin(data[1]);
 219              		.loc 1 24 20 discriminator 1 view .LVU42
 220 0038 6370     		strb	r3, [r4, #1]
 221              		.loc 1 26 2 is_stmt 1 view .LVU43
 222              		.loc 1 26 4 is_stmt 0 view .LVU44
 223 003a 6956     		ldrsb	r1, [r5, r1]
 224              		.loc 1 26 9 view .LVU45
 225 003c AB78     		ldrb	r3, [r5, #2]
 226              		.loc 1 26 4 view .LVU46
 227 003e 0029     		cmp	r1, #0
 228 0040 20DA     		bge	.L5
  27:Lib/SD3077.c  **** 		dateTime->ampm = HOUR24;
 229              		.loc 1 27 3 is_stmt 1 view .LVU47
  28:Lib/SD3077.c  **** 		dateTime->hours = bcd2bin(data[2] & 0x7F);
 230              		.loc 1 28 3 view .LVU48
 231              		.loc 1 28 21 is_stmt 0 view .LVU49
 232 0042 7F21     		movs	r1, #127
 233 0044 0B40     		ands	r3, r1
 234              	.LVL9:
 235              	.LBB40:
 236              	.LBI40:
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 237              		.loc 1 3 16 is_stmt 1 view .LVU50
 238              	.LBB41:
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 239              		.loc 1 3 40 view .LVU51
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 240              		.loc 1 3 51 is_stmt 0 view .LVU52
 241 0046 1909     		lsrs	r1, r3, #4
 242 0048 4A43     		muls	r2, r1
 243              	.LBE41:
ARM GAS  D:\Temp\cc8obYI6.s 			page 6


 244              	.LBE40:
 245 004a 0221     		movs	r1, #2
 246              	.LBB43:
 247              	.LBB42:
 248 004c 9B18     		adds	r3, r3, r2
 249              	.LVL10:
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 250              		.loc 1 3 51 view .LVU53
 251 004e DBB2     		uxtb	r3, r3
 252              	.LVL11:
 253              	.L6:
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 254              		.loc 1 3 51 view .LVU54
 255              	.LBE42:
 256              	.LBE43:
 257              		.loc 1 28 19 discriminator 1 view .LVU55
 258 0050 E370     		strb	r3, [r4, #3]
  29:Lib/SD3077.c  **** 	}
  30:Lib/SD3077.c  **** 	else{
  31:Lib/SD3077.c  **** 		dateTime->ampm =  (data[2] & 0x20) >> 5;
  32:Lib/SD3077.c  **** 		dateTime->hours = bcd2bin(data[2] & 0x1F);
  33:Lib/SD3077.c  **** 	}
  34:Lib/SD3077.c  **** 
  35:Lib/SD3077.c  **** 	dateTime->dayOfWeek = bcd2bin(data[3]);
 259              		.loc 1 35 2 is_stmt 1 view .LVU56
 260              	.LBB44:
 261              	.LBB45:
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 262              		.loc 1 3 51 is_stmt 0 view .LVU57
 263 0052 0623     		movs	r3, #6
 264              	.LBE45:
 265              	.LBE44:
  27:Lib/SD3077.c  **** 		dateTime->hours = bcd2bin(data[2] & 0x7F);
 266              		.loc 1 27 18 view .LVU58
 267 0054 A170     		strb	r1, [r4, #2]
 268              		.loc 1 35 24 view .LVU59
 269 0056 EA78     		ldrb	r2, [r5, #3]
 270              	.LVL12:
 271              	.LBB47:
 272              	.LBI44:
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 273              		.loc 1 3 16 is_stmt 1 view .LVU60
 274              	.LBB46:
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 275              		.loc 1 3 40 view .LVU61
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 276              		.loc 1 3 51 is_stmt 0 view .LVU62
 277 0058 5B42     		rsbs	r3, r3, #0
 278 005a 1109     		lsrs	r1, r2, #4
 279 005c 5943     		muls	r1, r3
 280 005e 5218     		adds	r2, r2, r1
 281              	.LBE46:
 282              	.LBE47:
 283              		.loc 1 35 22 discriminator 1 view .LVU63
 284 0060 2271     		strb	r2, [r4, #4]
  36:Lib/SD3077.c  **** 	dateTime->dayOfMonth = bcd2bin(data[4]);
 285              		.loc 1 36 2 is_stmt 1 view .LVU64
ARM GAS  D:\Temp\cc8obYI6.s 			page 7


 286              		.loc 1 36 25 is_stmt 0 view .LVU65
 287 0062 2A79     		ldrb	r2, [r5, #4]
 288              	.LVL13:
 289              	.LBB48:
 290              	.LBI48:
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 291              		.loc 1 3 16 is_stmt 1 view .LVU66
 292              	.LBB49:
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 293              		.loc 1 3 40 view .LVU67
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 294              		.loc 1 3 51 is_stmt 0 view .LVU68
 295 0064 1109     		lsrs	r1, r2, #4
 296 0066 5943     		muls	r1, r3
 297 0068 5218     		adds	r2, r2, r1
 298              	.LBE49:
 299              	.LBE48:
 300              		.loc 1 36 23 discriminator 1 view .LVU69
 301 006a 6271     		strb	r2, [r4, #5]
  37:Lib/SD3077.c  **** 	dateTime->month = bcd2bin(data[5]);
 302              		.loc 1 37 2 is_stmt 1 view .LVU70
 303              		.loc 1 37 20 is_stmt 0 view .LVU71
 304 006c 6A79     		ldrb	r2, [r5, #5]
 305              	.LVL14:
 306              	.LBB50:
 307              	.LBI50:
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 308              		.loc 1 3 16 is_stmt 1 view .LVU72
 309              	.LBB51:
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 310              		.loc 1 3 40 view .LVU73
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 311              		.loc 1 3 51 is_stmt 0 view .LVU74
 312 006e 1109     		lsrs	r1, r2, #4
 313 0070 5943     		muls	r1, r3
 314 0072 5218     		adds	r2, r2, r1
 315              	.LBE51:
 316              	.LBE50:
 317              		.loc 1 37 18 discriminator 1 view .LVU75
 318 0074 A271     		strb	r2, [r4, #6]
  38:Lib/SD3077.c  **** 	dateTime->year = bcd2bin(data[6]);
 319              		.loc 1 38 2 is_stmt 1 view .LVU76
 320              		.loc 1 38 19 is_stmt 0 view .LVU77
 321 0076 AA79     		ldrb	r2, [r5, #6]
 322              	.LVL15:
 323              	.LBB52:
 324              	.LBI52:
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 325              		.loc 1 3 16 is_stmt 1 view .LVU78
 326              	.LBB53:
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 327              		.loc 1 3 40 view .LVU79
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 328              		.loc 1 3 51 is_stmt 0 view .LVU80
 329 0078 1109     		lsrs	r1, r2, #4
 330 007a 4B43     		muls	r3, r1
 331 007c D218     		adds	r2, r2, r3
ARM GAS  D:\Temp\cc8obYI6.s 			page 8


 332              	.LBE53:
 333              	.LBE52:
 334              		.loc 1 38 17 discriminator 1 view .LVU81
 335 007e E271     		strb	r2, [r4, #7]
  39:Lib/SD3077.c  **** }
 336              		.loc 1 39 1 view .LVU82
 337 0080 07B0     		add	sp, sp, #28
 338              		@ sp needed
 339              	.LVL16:
 340              		.loc 1 39 1 view .LVU83
 341 0082 30BD     		pop	{r4, r5, pc}
 342              	.LVL17:
 343              	.L5:
  31:Lib/SD3077.c  **** 		dateTime->hours = bcd2bin(data[2] & 0x1F);
 344              		.loc 1 31 3 is_stmt 1 view .LVU84
  32:Lib/SD3077.c  **** 	}
 345              		.loc 1 32 21 is_stmt 0 view .LVU85
 346 0084 1F22     		movs	r2, #31
 347              	.LBB54:
 348              	.LBB55:
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 349              		.loc 1 3 51 view .LVU86
 350 0086 0520     		movs	r0, #5
 351              	.LBE55:
 352              	.LBE54:
  31:Lib/SD3077.c  **** 		dateTime->hours = bcd2bin(data[2] & 0x1F);
 353              		.loc 1 31 38 view .LVU87
 354 0088 9906     		lsls	r1, r3, #26
  32:Lib/SD3077.c  **** 	}
 355              		.loc 1 32 21 view .LVU88
 356 008a 1340     		ands	r3, r2
 357              	.LBB58:
 358              	.LBB56:
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 359              		.loc 1 3 51 view .LVU89
 360 008c 1A09     		lsrs	r2, r3, #4
 361 008e 5242     		rsbs	r2, r2, #0
 362 0090 8243     		bics	r2, r0
 363 0092 9B18     		adds	r3, r3, r2
 364              	.LBE56:
 365              	.LBE58:
  31:Lib/SD3077.c  **** 		dateTime->hours = bcd2bin(data[2] & 0x1F);
 366              		.loc 1 31 38 view .LVU90
 367 0094 C90F     		lsrs	r1, r1, #31
  32:Lib/SD3077.c  **** 	}
 368              		.loc 1 32 3 is_stmt 1 view .LVU91
 369              	.LBB59:
 370              	.LBI54:
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 371              		.loc 1 3 16 view .LVU92
 372              	.LBB57:
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 373              		.loc 1 3 40 view .LVU93
   3:Lib/SD3077.c  **** static uint8_t bin2bcd (uint8_t val) { return val + 6 * (val / 10); }
 374              		.loc 1 3 51 is_stmt 0 view .LVU94
 375 0096 DBB2     		uxtb	r3, r3
 376 0098 DAE7     		b	.L6
ARM GAS  D:\Temp\cc8obYI6.s 			page 9


 377              	.L8:
 378 009a C046     		.align	2
 379              	.L7:
 380 009c 00000000 		.word	hi2c1
 381              	.LBE57:
 382              	.LBE59:
 383              		.cfi_endproc
 384              	.LFE40:
 386              		.global	__aeabi_uidiv
 387              		.section	.text.SetTime,"ax",%progbits
 388              		.align	1
 389              		.global	SetTime
 390              		.syntax unified
 391              		.code	16
 392              		.thumb_func
 394              	SetTime:
 395              	.LVL18:
 396              	.LFB41:
  40:Lib/SD3077.c  **** 
  41:Lib/SD3077.c  **** void SetTime(DateTime *dateTime){
 397              		.loc 1 41 33 is_stmt 1 view -0
 398              		.cfi_startproc
 399              		@ args = 0, pretend = 0, frame = 16
 400              		@ frame_needed = 0, uses_anonymous_args = 0
  42:Lib/SD3077.c  **** 	// 解除写保护
  43:Lib/SD3077.c  **** 	UnlockWriteProtect();
 401              		.loc 1 43 2 view .LVU96
  41:Lib/SD3077.c  **** 	// 解除写保护
 402              		.loc 1 41 33 is_stmt 0 view .LVU97
 403 0000 F0B5     		push	{r4, r5, r6, r7, lr}
 404              	.LCFI4:
 405              		.cfi_def_cfa_offset 20
 406              		.cfi_offset 4, -20
 407              		.cfi_offset 5, -16
 408              		.cfi_offset 6, -12
 409              		.cfi_offset 7, -8
 410              		.cfi_offset 14, -4
 411 0002 0500     		movs	r5, r0
 412 0004 89B0     		sub	sp, sp, #36
 413              	.LCFI5:
 414              		.cfi_def_cfa_offset 56
 415              		.loc 1 43 2 view .LVU98
 416 0006 FFF7FEFF 		bl	UnlockWriteProtect
 417              	.LVL19:
  44:Lib/SD3077.c  **** 
  45:Lib/SD3077.c  **** 	uint8_t data[7];
 418              		.loc 1 45 2 is_stmt 1 view .LVU99
  46:Lib/SD3077.c  **** 	data[0] = bin2bcd(dateTime->seconds);
 419              		.loc 1 46 2 view .LVU100
 420              		.loc 1 46 12 is_stmt 0 view .LVU101
 421 000a 2C78     		ldrb	r4, [r5]
 422              	.LVL20:
 423              	.LBB60:
 424              	.LBI60:
   4:Lib/SD3077.c  **** 
 425              		.loc 1 4 16 is_stmt 1 view .LVU102
 426              	.LBB61:
ARM GAS  D:\Temp\cc8obYI6.s 			page 10


   4:Lib/SD3077.c  **** 
 427              		.loc 1 4 40 view .LVU103
   4:Lib/SD3077.c  **** 
 428              		.loc 1 4 51 is_stmt 0 view .LVU104
 429 000c 0A21     		movs	r1, #10
 430 000e 2000     		movs	r0, r4
 431 0010 FFF7FEFF 		bl	__aeabi_uidiv
 432              	.LVL21:
 433 0014 0627     		movs	r7, #6
 434 0016 7843     		muls	r0, r7
 435              	.LBE61:
 436              	.LBE60:
 437              		.loc 1 46 10 discriminator 1 view .LVU105
 438 0018 06AE     		add	r6, sp, #24
 439              	.LBB63:
 440              	.LBB62:
   4:Lib/SD3077.c  **** 
 441              		.loc 1 4 51 view .LVU106
 442 001a 2418     		adds	r4, r4, r0
 443              	.LBE62:
 444              	.LBE63:
 445              		.loc 1 46 10 discriminator 1 view .LVU107
 446 001c 3470     		strb	r4, [r6]
  47:Lib/SD3077.c  **** 	data[1] = bin2bcd(dateTime->minutes);
 447              		.loc 1 47 2 is_stmt 1 view .LVU108
 448              		.loc 1 47 12 is_stmt 0 view .LVU109
 449 001e 6C78     		ldrb	r4, [r5, #1]
 450              	.LVL22:
 451              	.LBB64:
 452              	.LBI64:
   4:Lib/SD3077.c  **** 
 453              		.loc 1 4 16 is_stmt 1 view .LVU110
 454              	.LBB65:
   4:Lib/SD3077.c  **** 
 455              		.loc 1 4 40 view .LVU111
   4:Lib/SD3077.c  **** 
 456              		.loc 1 4 51 is_stmt 0 view .LVU112
 457 0020 0A21     		movs	r1, #10
 458 0022 2000     		movs	r0, r4
 459 0024 FFF7FEFF 		bl	__aeabi_uidiv
 460              	.LVL23:
 461 0028 7843     		muls	r0, r7
 462 002a 2418     		adds	r4, r4, r0
 463              	.LBE65:
 464              	.LBE64:
 465              		.loc 1 47 10 discriminator 1 view .LVU113
 466 002c 7470     		strb	r4, [r6, #1]
  48:Lib/SD3077.c  **** 
  49:Lib/SD3077.c  **** 	// 小时需要特殊处理，先转BCD再设置格式位
  50:Lib/SD3077.c  **** 	if((dateTime -> ampm) == HOUR24){
 467              		.loc 1 50 2 is_stmt 1 view .LVU114
 468              		.loc 1 50 15 is_stmt 0 view .LVU115
 469 002e AB78     		ldrb	r3, [r5, #2]
 470              	.LBB66:
 471              	.LBB67:
   4:Lib/SD3077.c  **** 
 472              		.loc 1 4 51 view .LVU116
ARM GAS  D:\Temp\cc8obYI6.s 			page 11


 473 0030 0A21     		movs	r1, #10
 474              	.LBE67:
 475              	.LBE66:
 476              		.loc 1 50 15 view .LVU117
 477 0032 0593     		str	r3, [sp, #20]
 478 0034 EC78     		ldrb	r4, [r5, #3]
 479              	.LBB70:
 480              	.LBB68:
   4:Lib/SD3077.c  **** 
 481              		.loc 1 4 51 view .LVU118
 482 0036 2000     		movs	r0, r4
 483              	.LBE68:
 484              	.LBE70:
 485              		.loc 1 50 4 view .LVU119
 486 0038 022B     		cmp	r3, #2
 487 003a 37D1     		bne	.L10
  51:Lib/SD3077.c  **** 		data[2] = bin2bcd(dateTime->hours) | 0x80;  // 24小时制：BCD + 最高位为1
 488              		.loc 1 51 3 is_stmt 1 view .LVU120
 489              	.LVL24:
 490              	.LBB71:
 491              	.LBI66:
   4:Lib/SD3077.c  **** 
 492              		.loc 1 4 16 view .LVU121
 493              	.LBB69:
   4:Lib/SD3077.c  **** 
 494              		.loc 1 4 40 view .LVU122
   4:Lib/SD3077.c  **** 
 495              		.loc 1 4 51 is_stmt 0 view .LVU123
 496 003c FFF7FEFF 		bl	__aeabi_uidiv
 497              	.LVL25:
 498 0040 7843     		muls	r0, r7
 499 0042 2018     		adds	r0, r4, r0
 500              	.LBE69:
 501              	.LBE71:
 502              		.loc 1 51 11 discriminator 1 view .LVU124
 503 0044 8024     		movs	r4, #128
 504 0046 6442     		rsbs	r4, r4, #0
 505 0048 0443     		orrs	r4, r0
 506              	.L12:
  52:Lib/SD3077.c  **** 	}
  53:Lib/SD3077.c  **** 	else{
  54:Lib/SD3077.c  **** 		data[2] = bin2bcd(dateTime->hours) | ((dateTime -> ampm) << 5);  // 12小时制：BCD + AM/PM位
 507              		.loc 1 54 38 discriminator 1 view .LVU125
 508 004a E4B2     		uxtb	r4, r4
 509 004c B470     		strb	r4, [r6, #2]
  55:Lib/SD3077.c  **** 	}
  56:Lib/SD3077.c  **** 
  57:Lib/SD3077.c  **** 	data[3] = bin2bcd(dateTime->dayOfWeek);
 510              		.loc 1 57 2 is_stmt 1 view .LVU126
 511              		.loc 1 57 12 is_stmt 0 view .LVU127
 512 004e 2F79     		ldrb	r7, [r5, #4]
 513              	.LVL26:
 514              	.LBB72:
 515              	.LBI72:
   4:Lib/SD3077.c  **** 
 516              		.loc 1 4 16 is_stmt 1 view .LVU128
 517              	.LBB73:
ARM GAS  D:\Temp\cc8obYI6.s 			page 12


   4:Lib/SD3077.c  **** 
 518              		.loc 1 4 40 view .LVU129
   4:Lib/SD3077.c  **** 
 519              		.loc 1 4 51 is_stmt 0 view .LVU130
 520 0050 0A21     		movs	r1, #10
 521 0052 3800     		movs	r0, r7
 522 0054 FFF7FEFF 		bl	__aeabi_uidiv
 523              	.LVL27:
 524 0058 0624     		movs	r4, #6
 525 005a 6043     		muls	r0, r4
 526 005c 3F18     		adds	r7, r7, r0
 527              	.LBE73:
 528              	.LBE72:
 529              		.loc 1 57 10 discriminator 1 view .LVU131
 530 005e F770     		strb	r7, [r6, #3]
  58:Lib/SD3077.c  **** 	data[4] = bin2bcd(dateTime->dayOfMonth);
 531              		.loc 1 58 2 is_stmt 1 view .LVU132
 532              		.loc 1 58 12 is_stmt 0 view .LVU133
 533 0060 6F79     		ldrb	r7, [r5, #5]
 534              	.LVL28:
 535              	.LBB74:
 536              	.LBI74:
   4:Lib/SD3077.c  **** 
 537              		.loc 1 4 16 is_stmt 1 view .LVU134
 538              	.LBB75:
   4:Lib/SD3077.c  **** 
 539              		.loc 1 4 40 view .LVU135
   4:Lib/SD3077.c  **** 
 540              		.loc 1 4 51 is_stmt 0 view .LVU136
 541 0062 0A21     		movs	r1, #10
 542 0064 3800     		movs	r0, r7
 543 0066 FFF7FEFF 		bl	__aeabi_uidiv
 544              	.LVL29:
 545 006a 6043     		muls	r0, r4
 546 006c 3F18     		adds	r7, r7, r0
 547              	.LBE75:
 548              	.LBE74:
 549              		.loc 1 58 10 discriminator 1 view .LVU137
 550 006e 3771     		strb	r7, [r6, #4]
  59:Lib/SD3077.c  **** 	data[5] = bin2bcd(dateTime->month);
 551              		.loc 1 59 2 is_stmt 1 view .LVU138
 552              		.loc 1 59 12 is_stmt 0 view .LVU139
 553 0070 AF79     		ldrb	r7, [r5, #6]
 554              	.LVL30:
 555              	.LBB76:
 556              	.LBI76:
   4:Lib/SD3077.c  **** 
 557              		.loc 1 4 16 is_stmt 1 view .LVU140
 558              	.LBB77:
   4:Lib/SD3077.c  **** 
 559              		.loc 1 4 40 view .LVU141
   4:Lib/SD3077.c  **** 
 560              		.loc 1 4 51 is_stmt 0 view .LVU142
 561 0072 0A21     		movs	r1, #10
 562 0074 3800     		movs	r0, r7
 563 0076 FFF7FEFF 		bl	__aeabi_uidiv
 564              	.LVL31:
ARM GAS  D:\Temp\cc8obYI6.s 			page 13


 565 007a 6043     		muls	r0, r4
 566 007c 3F18     		adds	r7, r7, r0
 567              	.LBE77:
 568              	.LBE76:
 569              		.loc 1 59 10 discriminator 1 view .LVU143
 570 007e 7771     		strb	r7, [r6, #5]
  60:Lib/SD3077.c  **** 	data[6] = bin2bcd(dateTime->year);
 571              		.loc 1 60 2 is_stmt 1 view .LVU144
 572              		.loc 1 60 12 is_stmt 0 view .LVU145
 573 0080 ED79     		ldrb	r5, [r5, #7]
 574              	.LVL32:
 575              	.LBB78:
 576              	.LBI78:
   4:Lib/SD3077.c  **** 
 577              		.loc 1 4 16 is_stmt 1 view .LVU146
 578              	.LBB79:
   4:Lib/SD3077.c  **** 
 579              		.loc 1 4 40 view .LVU147
   4:Lib/SD3077.c  **** 
 580              		.loc 1 4 51 is_stmt 0 view .LVU148
 581 0082 0A21     		movs	r1, #10
 582 0084 2800     		movs	r0, r5
 583 0086 FFF7FEFF 		bl	__aeabi_uidiv
 584              	.LVL33:
 585              	.LBE79:
 586              	.LBE78:
  61:Lib/SD3077.c  **** 
  62:Lib/SD3077.c  **** 	HAL_I2C_Mem_Write(&SD3077_IIC_HANDLE, SD3077_IIC_ADDR_WRITE, 0x00, 1, data, 7, HAL_MAX_DELAY);
 587              		.loc 1 62 2 view .LVU149
 588 008a 0123     		movs	r3, #1
 589              	.LBB82:
 590              	.LBB80:
   4:Lib/SD3077.c  **** 
 591              		.loc 1 4 51 view .LVU150
 592 008c 4443     		muls	r4, r0
 593              	.LBE80:
 594              	.LBE82:
 595              		.loc 1 62 2 view .LVU151
 596 008e 5B42     		rsbs	r3, r3, #0
 597              	.LBB83:
 598              	.LBB81:
   4:Lib/SD3077.c  **** 
 599              		.loc 1 4 51 view .LVU152
 600 0090 2D19     		adds	r5, r5, r4
 601              	.LBE81:
 602              	.LBE83:
  60:Lib/SD3077.c  **** 
 603              		.loc 1 60 10 discriminator 1 view .LVU153
 604 0092 B571     		strb	r5, [r6, #6]
 605              		.loc 1 62 2 is_stmt 1 view .LVU154
 606 0094 0293     		str	r3, [sp, #8]
 607 0096 0833     		adds	r3, r3, #8
 608 0098 0193     		str	r3, [sp, #4]
 609 009a 0022     		movs	r2, #0
 610 009c 6421     		movs	r1, #100
 611 009e 0096     		str	r6, [sp]
 612 00a0 063B     		subs	r3, r3, #6
ARM GAS  D:\Temp\cc8obYI6.s 			page 14


 613 00a2 0648     		ldr	r0, .L13
 614 00a4 FFF7FEFF 		bl	HAL_I2C_Mem_Write
 615              	.LVL34:
  63:Lib/SD3077.c  **** }
 616              		.loc 1 63 1 is_stmt 0 view .LVU155
 617 00a8 09B0     		add	sp, sp, #36
 618              		@ sp needed
 619 00aa F0BD     		pop	{r4, r5, r6, r7, pc}
 620              	.LVL35:
 621              	.L10:
  54:Lib/SD3077.c  **** 	}
 622              		.loc 1 54 3 is_stmt 1 view .LVU156
 623              	.LBB84:
 624              	.LBI84:
   4:Lib/SD3077.c  **** 
 625              		.loc 1 4 16 view .LVU157
 626              	.LBB85:
   4:Lib/SD3077.c  **** 
 627              		.loc 1 4 40 view .LVU158
   4:Lib/SD3077.c  **** 
 628              		.loc 1 4 51 is_stmt 0 view .LVU159
 629 00ac FFF7FEFF 		bl	__aeabi_uidiv
 630              	.LVL36:
 631 00b0 4743     		muls	r7, r0
 632              	.LBE85:
 633              	.LBE84:
  54:Lib/SD3077.c  **** 	}
 634              		.loc 1 54 38 discriminator 1 view .LVU160
 635 00b2 059B     		ldr	r3, [sp, #20]
 636              	.LBB87:
 637              	.LBB86:
   4:Lib/SD3077.c  **** 
 638              		.loc 1 4 51 view .LVU161
 639 00b4 E419     		adds	r4, r4, r7
 640              	.LBE86:
 641              	.LBE87:
  54:Lib/SD3077.c  **** 	}
 642              		.loc 1 54 38 discriminator 1 view .LVU162
 643 00b6 5B01     		lsls	r3, r3, #5
 644 00b8 1C43     		orrs	r4, r3
 645 00ba C6E7     		b	.L12
 646              	.L14:
 647              		.align	2
 648              	.L13:
 649 00bc 00000000 		.word	hi2c1
 650              		.cfi_endproc
 651              	.LFE41:
 653              		.section	.text.EnableSencodInterruptOuput,"ax",%progbits
 654              		.align	1
 655              		.global	EnableSencodInterruptOuput
 656              		.syntax unified
 657              		.code	16
 658              		.thumb_func
 660              	EnableSencodInterruptOuput:
 661              	.LFB42:
  64:Lib/SD3077.c  **** 
  65:Lib/SD3077.c  **** void EnableSencodInterruptOuput(){
ARM GAS  D:\Temp\cc8obYI6.s 			page 15


 662              		.loc 1 65 34 is_stmt 1 view -0
 663              		.cfi_startproc
 664              		@ args = 0, pretend = 0, frame = 8
 665              		@ frame_needed = 0, uses_anonymous_args = 0
  66:Lib/SD3077.c  **** 	// 解除写保护
  67:Lib/SD3077.c  **** 	UnlockWriteProtect();
 666              		.loc 1 67 2 view .LVU164
  65:Lib/SD3077.c  **** 	// 解除写保护
 667              		.loc 1 65 34 is_stmt 0 view .LVU165
 668 0000 F0B5     		push	{r4, r5, r6, r7, lr}
 669              	.LCFI6:
 670              		.cfi_def_cfa_offset 20
 671              		.cfi_offset 4, -20
 672              		.cfi_offset 5, -16
 673              		.cfi_offset 6, -12
 674              		.cfi_offset 7, -8
 675              		.cfi_offset 14, -4
  68:Lib/SD3077.c  **** 
  69:Lib/SD3077.c  **** 	// 读出控制寄存器2和3
  70:Lib/SD3077.c  **** 	uint8_t data[2];
  71:Lib/SD3077.c  **** 	HAL_I2C_Mem_Read(&SD3077_IIC_HANDLE, SD3077_IIC_ADDR_READ, 0x10, 1, data, 2, HAL_MAX_DELAY);
 676              		.loc 1 71 2 view .LVU166
 677 0002 0127     		movs	r7, #1
 678 0004 0226     		movs	r6, #2
  65:Lib/SD3077.c  **** 	// 解除写保护
 679              		.loc 1 65 34 view .LVU167
 680 0006 87B0     		sub	sp, sp, #28
 681              	.LCFI7:
 682              		.cfi_def_cfa_offset 48
  67:Lib/SD3077.c  **** 
 683              		.loc 1 67 2 view .LVU168
 684 0008 FFF7FEFF 		bl	UnlockWriteProtect
 685              	.LVL37:
  70:Lib/SD3077.c  **** 	HAL_I2C_Mem_Read(&SD3077_IIC_HANDLE, SD3077_IIC_ADDR_READ, 0x10, 1, data, 2, HAL_MAX_DELAY);
 686              		.loc 1 70 2 is_stmt 1 view .LVU169
 687              		.loc 1 71 2 view .LVU170
 688 000c 0F4D     		ldr	r5, .L16
 689 000e 05AC     		add	r4, sp, #20
 690 0010 7F42     		rsbs	r7, r7, #0
 691 0012 0123     		movs	r3, #1
 692 0014 1022     		movs	r2, #16
 693 0016 6521     		movs	r1, #101
 694 0018 2800     		movs	r0, r5
 695 001a 0297     		str	r7, [sp, #8]
 696 001c 0196     		str	r6, [sp, #4]
 697 001e 0094     		str	r4, [sp]
 698 0020 FFF7FEFF 		bl	HAL_I2C_Mem_Read
 699              	.LVL38:
  72:Lib/SD3077.c  **** 
  73:Lib/SD3077.c  **** 	// 允许频率中断
  74:Lib/SD3077.c  **** 	data[0] |= 0x01;
 700              		.loc 1 74 2 view .LVU171
  75:Lib/SD3077.c  **** 	// 选择频率中断输出
  76:Lib/SD3077.c  **** 	data[0] |= 0x20;
 701              		.loc 1 76 2 view .LVU172
  77:Lib/SD3077.c  **** 	data[0] &= 0xEF;
 702              		.loc 1 77 2 view .LVU173
ARM GAS  D:\Temp\cc8obYI6.s 			page 16


 703              		.loc 1 77 10 is_stmt 0 view .LVU174
 704 0024 1022     		movs	r2, #16
 705 0026 2123     		movs	r3, #33
 706 0028 2178     		ldrb	r1, [r4]
  78:Lib/SD3077.c  **** 
  79:Lib/SD3077.c  **** 	// 设置频率为1Hz
  80:Lib/SD3077.c  **** //	data[1] &= 0xF0;
  81:Lib/SD3077.c  **** //	data[1] |= 0x0A;
  82:Lib/SD3077.c  **** 
  83:Lib/SD3077.c  **** 	// 设置频率为1秒
  84:Lib/SD3077.c  **** 	data[1] |= 0x0F;
  85:Lib/SD3077.c  **** 
  86:Lib/SD3077.c  **** 	// 控制寄存器回写
  87:Lib/SD3077.c  **** 	HAL_I2C_Mem_Write(&SD3077_IIC_HANDLE, SD3077_IIC_ADDR_WRITE, 0x10, 1, data, 2, HAL_MAX_DELAY);
 707              		.loc 1 87 2 view .LVU175
 708 002a 2800     		movs	r0, r5
  77:Lib/SD3077.c  **** 	data[0] &= 0xEF;
 709              		.loc 1 77 10 view .LVU176
 710 002c 9143     		bics	r1, r2
 711 002e 0B43     		orrs	r3, r1
 712 0030 2370     		strb	r3, [r4]
  84:Lib/SD3077.c  **** 
 713              		.loc 1 84 2 is_stmt 1 view .LVU177
  84:Lib/SD3077.c  **** 
 714              		.loc 1 84 10 is_stmt 0 view .LVU178
 715 0032 0F23     		movs	r3, #15
 716 0034 6178     		ldrb	r1, [r4, #1]
 717 0036 0B43     		orrs	r3, r1
 718 0038 6370     		strb	r3, [r4, #1]
 719              		.loc 1 87 2 is_stmt 1 view .LVU179
 720 003a 6421     		movs	r1, #100
 721 003c 0123     		movs	r3, #1
 722 003e 0297     		str	r7, [sp, #8]
 723 0040 0196     		str	r6, [sp, #4]
 724 0042 0094     		str	r4, [sp]
 725 0044 FFF7FEFF 		bl	HAL_I2C_Mem_Write
 726              	.LVL39:
  88:Lib/SD3077.c  **** }
 727              		.loc 1 88 1 is_stmt 0 view .LVU180
 728 0048 07B0     		add	sp, sp, #28
 729              		@ sp needed
 730 004a F0BD     		pop	{r4, r5, r6, r7, pc}
 731              	.L17:
 732              		.align	2
 733              	.L16:
 734 004c 00000000 		.word	hi2c1
 735              		.cfi_endproc
 736              	.LFE42:
 738              		.section	.text.SetInterruptOuput,"ax",%progbits
 739              		.align	1
 740              		.global	SetInterruptOuput
 741              		.syntax unified
 742              		.code	16
 743              		.thumb_func
 745              	SetInterruptOuput:
 746              	.LVL40:
 747              	.LFB43:
ARM GAS  D:\Temp\cc8obYI6.s 			page 17


  89:Lib/SD3077.c  **** 
  90:Lib/SD3077.c  **** void SetInterruptOuput(SD3077IntFreq freq){
 748              		.loc 1 90 43 is_stmt 1 view -0
 749              		.cfi_startproc
 750              		@ args = 0, pretend = 0, frame = 16
 751              		@ frame_needed = 0, uses_anonymous_args = 0
  91:Lib/SD3077.c  **** 	// 解除写保护
  92:Lib/SD3077.c  **** 	UnlockWriteProtect();
 752              		.loc 1 92 2 view .LVU182
  90:Lib/SD3077.c  **** 	// 解除写保护
 753              		.loc 1 90 43 is_stmt 0 view .LVU183
 754 0000 F0B5     		push	{r4, r5, r6, r7, lr}
 755              	.LCFI8:
 756              		.cfi_def_cfa_offset 20
 757              		.cfi_offset 4, -20
 758              		.cfi_offset 5, -16
 759              		.cfi_offset 6, -12
 760              		.cfi_offset 7, -8
 761              		.cfi_offset 14, -4
  93:Lib/SD3077.c  **** 
  94:Lib/SD3077.c  **** 	// 读出控制寄存器2和3
  95:Lib/SD3077.c  **** 	uint8_t data[2];
  96:Lib/SD3077.c  **** 	HAL_I2C_Mem_Read(&SD3077_IIC_HANDLE, SD3077_IIC_ADDR_READ, 0x10, 1, data, 2, HAL_MAX_DELAY);
 762              		.loc 1 96 2 view .LVU184
 763 0002 0127     		movs	r7, #1
 764 0004 0226     		movs	r6, #2
  90:Lib/SD3077.c  **** 	// 解除写保护
 765              		.loc 1 90 43 view .LVU185
 766 0006 89B0     		sub	sp, sp, #36
 767              	.LCFI9:
 768              		.cfi_def_cfa_offset 56
  90:Lib/SD3077.c  **** 	// 解除写保护
 769              		.loc 1 90 43 view .LVU186
 770 0008 0590     		str	r0, [sp, #20]
  92:Lib/SD3077.c  **** 
 771              		.loc 1 92 2 view .LVU187
 772 000a FFF7FEFF 		bl	UnlockWriteProtect
 773              	.LVL41:
  95:Lib/SD3077.c  **** 	HAL_I2C_Mem_Read(&SD3077_IIC_HANDLE, SD3077_IIC_ADDR_READ, 0x10, 1, data, 2, HAL_MAX_DELAY);
 774              		.loc 1 95 2 is_stmt 1 view .LVU188
 775              		.loc 1 96 2 view .LVU189
 776 000e 114D     		ldr	r5, .L19
 777 0010 07AC     		add	r4, sp, #28
 778 0012 7F42     		rsbs	r7, r7, #0
 779 0014 0123     		movs	r3, #1
 780 0016 1022     		movs	r2, #16
 781 0018 6521     		movs	r1, #101
 782 001a 2800     		movs	r0, r5
 783 001c 0297     		str	r7, [sp, #8]
 784 001e 0196     		str	r6, [sp, #4]
 785 0020 0094     		str	r4, [sp]
 786 0022 FFF7FEFF 		bl	HAL_I2C_Mem_Read
 787              	.LVL42:
  97:Lib/SD3077.c  **** 
  98:Lib/SD3077.c  **** 	// 允许频率中断
  99:Lib/SD3077.c  **** 	data[0] |= 0x01;
 788              		.loc 1 99 2 view .LVU190
ARM GAS  D:\Temp\cc8obYI6.s 			page 18


 100:Lib/SD3077.c  **** 	// 选择频率中断输出
 101:Lib/SD3077.c  **** 	data[0] |= 0x20;
 789              		.loc 1 101 2 view .LVU191
 102:Lib/SD3077.c  **** 	data[0] &= 0xEF;
 790              		.loc 1 102 2 view .LVU192
 791              		.loc 1 102 10 is_stmt 0 view .LVU193
 792 0026 1022     		movs	r2, #16
 793 0028 2123     		movs	r3, #33
 794 002a 2178     		ldrb	r1, [r4]
 103:Lib/SD3077.c  **** 
 104:Lib/SD3077.c  **** 	// 设置频率为1Hz
 105:Lib/SD3077.c  **** 	data[1] &= 0xF0;
 106:Lib/SD3077.c  **** 	data[1] |= freq;
 107:Lib/SD3077.c  **** 
 108:Lib/SD3077.c  **** 	// 设置频率为1秒
 109:Lib/SD3077.c  **** //	data[1] |= 0x0F;
 110:Lib/SD3077.c  **** 
 111:Lib/SD3077.c  **** 	// 控制寄存器回写
 112:Lib/SD3077.c  **** 	HAL_I2C_Mem_Write(&SD3077_IIC_HANDLE, SD3077_IIC_ADDR_WRITE, 0x10, 1, data, 2, HAL_MAX_DELAY);
 795              		.loc 1 112 2 view .LVU194
 796 002c 2800     		movs	r0, r5
 102:Lib/SD3077.c  **** 	data[0] &= 0xEF;
 797              		.loc 1 102 10 view .LVU195
 798 002e 9143     		bics	r1, r2
 799 0030 0B43     		orrs	r3, r1
 105:Lib/SD3077.c  **** 	data[1] |= freq;
 800              		.loc 1 105 10 view .LVU196
 801 0032 0F21     		movs	r1, #15
 102:Lib/SD3077.c  **** 	data[0] &= 0xEF;
 802              		.loc 1 102 10 view .LVU197
 803 0034 2370     		strb	r3, [r4]
 105:Lib/SD3077.c  **** 	data[1] |= freq;
 804              		.loc 1 105 2 is_stmt 1 view .LVU198
 106:Lib/SD3077.c  **** 
 805              		.loc 1 106 2 view .LVU199
 105:Lib/SD3077.c  **** 	data[1] |= freq;
 806              		.loc 1 105 10 is_stmt 0 view .LVU200
 807 0036 6378     		ldrb	r3, [r4, #1]
 808 0038 8B43     		bics	r3, r1
 106:Lib/SD3077.c  **** 
 809              		.loc 1 106 10 view .LVU201
 810 003a 0599     		ldr	r1, [sp, #20]
 811 003c 1943     		orrs	r1, r3
 812 003e 6170     		strb	r1, [r4, #1]
 813              		.loc 1 112 2 is_stmt 1 view .LVU202
 814 0040 0123     		movs	r3, #1
 815 0042 6421     		movs	r1, #100
 816 0044 0297     		str	r7, [sp, #8]
 817 0046 0196     		str	r6, [sp, #4]
 818 0048 0094     		str	r4, [sp]
 819 004a FFF7FEFF 		bl	HAL_I2C_Mem_Write
 820              	.LVL43:
 113:Lib/SD3077.c  **** }
 821              		.loc 1 113 1 is_stmt 0 view .LVU203
 822 004e 09B0     		add	sp, sp, #36
 823              		@ sp needed
 824 0050 F0BD     		pop	{r4, r5, r6, r7, pc}
ARM GAS  D:\Temp\cc8obYI6.s 			page 19


 825              	.L20:
 826 0052 C046     		.align	2
 827              	.L19:
 828 0054 00000000 		.word	hi2c1
 829              		.cfi_endproc
 830              	.LFE43:
 832              		.section	.text.WriteBackData,"ax",%progbits
 833              		.align	1
 834              		.global	WriteBackData
 835              		.syntax unified
 836              		.code	16
 837              		.thumb_func
 839              	WriteBackData:
 840              	.LVL44:
 841              	.LFB44:
 114:Lib/SD3077.c  **** 
 115:Lib/SD3077.c  **** void WriteBackData(uint8_t index, uint8_t *data, uint8_t size){
 842              		.loc 1 115 63 is_stmt 1 view -0
 843              		.cfi_startproc
 844              		@ args = 0, pretend = 0, frame = 0
 845              		@ frame_needed = 0, uses_anonymous_args = 0
 116:Lib/SD3077.c  **** 	if(index > 69) return;
 846              		.loc 1 116 2 view .LVU205
 115:Lib/SD3077.c  **** 	if(index > 69) return;
 847              		.loc 1 115 63 is_stmt 0 view .LVU206
 848 0000 7FB5     		push	{r0, r1, r2, r3, r4, r5, r6, lr}
 849              	.LCFI10:
 850              		.cfi_def_cfa_offset 32
 851              		.cfi_offset 0, -32
 852              		.cfi_offset 1, -28
 853              		.cfi_offset 2, -24
 854              		.cfi_offset 3, -20
 855              		.cfi_offset 4, -16
 856              		.cfi_offset 5, -12
 857              		.cfi_offset 6, -8
 858              		.cfi_offset 14, -4
 115:Lib/SD3077.c  **** 	if(index > 69) return;
 859              		.loc 1 115 63 view .LVU207
 860 0002 0400     		movs	r4, r0
 861 0004 0D00     		movs	r5, r1
 862 0006 1600     		movs	r6, r2
 863              		.loc 1 116 4 view .LVU208
 864 0008 4528     		cmp	r0, #69
 865 000a 0DD8     		bhi	.L21
 117:Lib/SD3077.c  **** 
 118:Lib/SD3077.c  **** 	// 解除写保护
 119:Lib/SD3077.c  **** 	UnlockWriteProtect();
 866              		.loc 1 119 2 is_stmt 1 view .LVU209
 867 000c FFF7FEFF 		bl	UnlockWriteProtect
 868              	.LVL45:
 120:Lib/SD3077.c  **** 
 121:Lib/SD3077.c  **** 	// 写入备份寄存器
 122:Lib/SD3077.c  **** 	HAL_I2C_Mem_Write(&SD3077_IIC_HANDLE, SD3077_IIC_ADDR_WRITE, 0x2C + index, 1, data, size, HAL_MAX_
 869              		.loc 1 122 2 view .LVU210
 870 0010 0123     		movs	r3, #1
 871 0012 2200     		movs	r2, r4
 872 0014 5B42     		rsbs	r3, r3, #0
ARM GAS  D:\Temp\cc8obYI6.s 			page 20


 873 0016 0293     		str	r3, [sp, #8]
 874 0018 6421     		movs	r1, #100
 875 001a 0448     		ldr	r0, .L23
 876 001c 2C32     		adds	r2, r2, #44
 877 001e 0196     		str	r6, [sp, #4]
 878 0020 0095     		str	r5, [sp]
 879 0022 0233     		adds	r3, r3, #2
 880 0024 FFF7FEFF 		bl	HAL_I2C_Mem_Write
 881              	.LVL46:
 882              	.L21:
 123:Lib/SD3077.c  **** }
 883              		.loc 1 123 1 is_stmt 0 view .LVU211
 884              		@ sp needed
 885              	.LVL47:
 886              	.LVL48:
 887              	.LVL49:
 888              		.loc 1 123 1 view .LVU212
 889 0028 7FBD     		pop	{r0, r1, r2, r3, r4, r5, r6, pc}
 890              	.L24:
 891 002a C046     		.align	2
 892              	.L23:
 893 002c 00000000 		.word	hi2c1
 894              		.cfi_endproc
 895              	.LFE44:
 897              		.section	.text.ReadBackData,"ax",%progbits
 898              		.align	1
 899              		.global	ReadBackData
 900              		.syntax unified
 901              		.code	16
 902              		.thumb_func
 904              	ReadBackData:
 905              	.LVL50:
 906              	.LFB45:
 124:Lib/SD3077.c  **** 
 125:Lib/SD3077.c  **** void ReadBackData(uint8_t index, uint8_t *data, uint8_t size){
 907              		.loc 1 125 62 is_stmt 1 view -0
 908              		.cfi_startproc
 909              		@ args = 0, pretend = 0, frame = 0
 910              		@ frame_needed = 0, uses_anonymous_args = 0
 126:Lib/SD3077.c  **** 	if(index > 69) return;
 911              		.loc 1 126 2 view .LVU214
 125:Lib/SD3077.c  **** 	if(index > 69) return;
 912              		.loc 1 125 62 is_stmt 0 view .LVU215
 913 0000 1FB5     		push	{r0, r1, r2, r3, r4, lr}
 914              	.LCFI11:
 915              		.cfi_def_cfa_offset 24
 916              		.cfi_offset 0, -24
 917              		.cfi_offset 1, -20
 918              		.cfi_offset 2, -16
 919              		.cfi_offset 3, -12
 920              		.cfi_offset 4, -8
 921              		.cfi_offset 14, -4
 125:Lib/SD3077.c  **** 	if(index > 69) return;
 922              		.loc 1 125 62 view .LVU216
 923 0002 1300     		movs	r3, r2
 924              		.loc 1 126 4 view .LVU217
 925 0004 4528     		cmp	r0, #69
ARM GAS  D:\Temp\cc8obYI6.s 			page 21


 926 0006 0BD8     		bhi	.L25
 127:Lib/SD3077.c  **** 
 128:Lib/SD3077.c  **** 	// 从备份寄存器读出
 129:Lib/SD3077.c  **** 	HAL_I2C_Mem_Read(&SD3077_IIC_HANDLE, SD3077_IIC_ADDR_READ, 0x2C + index, 1, data, size, HAL_MAX_DE
 927              		.loc 1 129 2 is_stmt 1 view .LVU218
 928 0008 0124     		movs	r4, #1
 929 000a 0200     		movs	r2, r0
 930              	.LVL51:
 931              		.loc 1 129 2 is_stmt 0 view .LVU219
 932 000c 6442     		rsbs	r4, r4, #0
 933 000e 0193     		str	r3, [sp, #4]
 934 0010 0091     		str	r1, [sp]
 935 0012 0123     		movs	r3, #1
 936              	.LVL52:
 937              		.loc 1 129 2 view .LVU220
 938 0014 6521     		movs	r1, #101
 939              	.LVL53:
 940              		.loc 1 129 2 view .LVU221
 941 0016 0348     		ldr	r0, .L27
 942              	.LVL54:
 943              		.loc 1 129 2 view .LVU222
 944 0018 2C32     		adds	r2, r2, #44
 945              	.LVL55:
 946              		.loc 1 129 2 view .LVU223
 947 001a 0294     		str	r4, [sp, #8]
 948 001c FFF7FEFF 		bl	HAL_I2C_Mem_Read
 949              	.LVL56:
 950              	.L25:
 130:Lib/SD3077.c  **** }
 951              		.loc 1 130 1 view .LVU224
 952              		@ sp needed
 953 0020 1FBD     		pop	{r0, r1, r2, r3, r4, pc}
 954              	.L28:
 955 0022 C046     		.align	2
 956              	.L27:
 957 0024 00000000 		.word	hi2c1
 958              		.cfi_endproc
 959              	.LFE45:
 961              		.text
 962              	.Letext0:
 963              		.file 2 "D:\\STM32CubeCLT\\STM32CubeCLT_1.18.0\\GNU-tools-for-STM32\\bin/../lib/gcc/arm-none-eabi/
 964              		.file 3 "D:\\STM32CubeCLT\\STM32CubeCLT_1.18.0\\GNU-tools-for-STM32\\bin/../lib/gcc/arm-none-eabi/
 965              		.file 4 "Drivers/CMSIS/Device/ST/STM32F0xx/Include/stm32f030x6.h"
 966              		.file 5 "Drivers/STM32F0xx_HAL_Driver/Inc/stm32f0xx_hal_def.h"
 967              		.file 6 "Drivers/STM32F0xx_HAL_Driver/Inc/stm32f0xx_hal_dma.h"
 968              		.file 7 "Drivers/STM32F0xx_HAL_Driver/Inc/stm32f0xx_hal_i2c.h"
 969              		.file 8 "Lib/SD3077.h"
 970              		.file 9 "Inc/i2c.h"
ARM GAS  D:\Temp\cc8obYI6.s 			page 22


DEFINED SYMBOLS
                            *ABS*:00000000 SD3077.c
  D:\Temp\cc8obYI6.s:19     .text.UnlockWriteProtect:00000000 $t
  D:\Temp\cc8obYI6.s:24     .text.UnlockWriteProtect:00000000 UnlockWriteProtect
  D:\Temp\cc8obYI6.s:127    .text.UnlockWriteProtect:00000084 $d
  D:\Temp\cc8obYI6.s:132    .text.TimeNow:00000000 $t
  D:\Temp\cc8obYI6.s:138    .text.TimeNow:00000000 TimeNow
  D:\Temp\cc8obYI6.s:380    .text.TimeNow:0000009c $d
  D:\Temp\cc8obYI6.s:388    .text.SetTime:00000000 $t
  D:\Temp\cc8obYI6.s:394    .text.SetTime:00000000 SetTime
  D:\Temp\cc8obYI6.s:649    .text.SetTime:000000bc $d
  D:\Temp\cc8obYI6.s:654    .text.EnableSencodInterruptOuput:00000000 $t
  D:\Temp\cc8obYI6.s:660    .text.EnableSencodInterruptOuput:00000000 EnableSencodInterruptOuput
  D:\Temp\cc8obYI6.s:734    .text.EnableSencodInterruptOuput:0000004c $d
  D:\Temp\cc8obYI6.s:739    .text.SetInterruptOuput:00000000 $t
  D:\Temp\cc8obYI6.s:745    .text.SetInterruptOuput:00000000 SetInterruptOuput
  D:\Temp\cc8obYI6.s:828    .text.SetInterruptOuput:00000054 $d
  D:\Temp\cc8obYI6.s:833    .text.WriteBackData:00000000 $t
  D:\Temp\cc8obYI6.s:839    .text.WriteBackData:00000000 WriteBackData
  D:\Temp\cc8obYI6.s:893    .text.WriteBackData:0000002c $d
  D:\Temp\cc8obYI6.s:898    .text.ReadBackData:00000000 $t
  D:\Temp\cc8obYI6.s:904    .text.ReadBackData:00000000 ReadBackData
  D:\Temp\cc8obYI6.s:957    .text.ReadBackData:00000024 $d

UNDEFINED SYMBOLS
HAL_I2C_Mem_Read
HAL_I2C_Mem_Write
hi2c1
__aeabi_uidiv
